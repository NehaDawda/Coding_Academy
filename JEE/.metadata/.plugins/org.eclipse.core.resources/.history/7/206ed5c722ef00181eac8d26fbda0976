package com.jp;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Iterator;
import java.util.LinkedList;

public class DBTableData {
	private String tableName;
	private String schemaName;
	private LinkedList<DBTableRow> datarows;
	
	public DBTableData(String tableName,String schemaName){
		this.tableName = tableName;
		this.schemaName = schemaName;
		setDBTableData();
	}
	
	private void setDBTableData(){
		Connection con = null;
		Statement stmt = null;
        ResultSet rs = null;
		
        LinkedList<DBTableRow> rows = new LinkedList();
        
        try{
        	Class.forName("oracle.jdbc.OracleDriver");
            con = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521/orcl","hr","hr");
            
            stmt = con.createStatement();
            rs = stmt.executeQuery("select * from " + this.tableName);
            
            while(rs.next()){
            	DBTableRow row = new DBTableRow();
            	LinkedList cols = new DBTableMetaData(this.tableName,this.schemaName).getColumnMetaData();
            	
            	Iterator<E> it = cols.iterator();
            	
            	while(it.hasnext()){
            		DBTableColumnMetaData colMetadata = it.next();
            		//if(colMetadata.getDataType().equals("VARCHAR2"))
            	}
            	
            	String name = rs.getString(4);
            	String datatype = rs.getString(5);
            	
            	DBTableColumnMetaData col = new DBTableColumnMetaData(name,datatype);
            	cols.add(col);
            }
            
        }catch(SQLException | ClassNotFoundException e){
        	e.printStackTrace();
        }finally{
        	try{
        	rs.close();
        	con.close();
        	}catch(SQLException e){
        		e.printStackTrace();
        	}
        }
	}
}
